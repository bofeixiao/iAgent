# iData AI 平台 - Spring Boot 配置文件模板
# 此文件包含所有可用的配置选项，请根据实际环境修改

server:
  port: 8081                              # ⚠️ 修改为对应的服务端口
  servlet:
    context-path: /api                    # API 前缀
  tomcat:
    threads:
      max: 200
      min-spare: 10
    max-connections: 10000
    connection-timeout: 60000

spring:
  application:
    name: idata-auth                      # ⚠️ 修改为对应的服务名

  # ===== 数据源配置 =====
  datasource:
    url: jdbc:mysql://localhost:3306/idata_ai?useUnicode=true&characterEncoding=utf8mb4&useSSL=false&serverTimezone=Asia/Shanghai
    username: idata                       # ⚠️ 修改为实际数据库用户
    password: Idata@123456               # ⚠️ 修改为实际数据库密码
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20               # 连接池最大连接数
      minimum-idle: 5                     # 最小空闲连接数
      connection-timeout: 30000           # 连接超时(毫秒)
      idle-timeout: 600000                # 空闲超时(毫秒)
      max-lifetime: 1800000               # 最大生命周期(毫秒)

  # ===== Redis 配置 =====
  redis:
    host: localhost                       # ⚠️ 修改为实际 Redis 主机
    port: 6379                            # ⚠️ 修改为实际 Redis 端口
    password: ''                          # ⚠️ 如有密码请修改
    timeout: 2000
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0

  # ===== RabbitMQ 配置 =====
  rabbitmq:
    host: localhost                       # ⚠️ 修改为实际 RabbitMQ 主机
    port: 5672                            # ⚠️ 修改为实际 RabbitMQ 端口
    username: idata                       # ⚠️ 修改为实际用户名
    password: Idata@123456               # ⚠️ 修改为实际密码
    virtual-host: /                       # 虚拟主机

  # ===== JPA 配置 =====
  jpa:
    hibernate:
      ddl-auto: validate                  # validate/create/update/create-drop
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true
        dialect: org.hibernate.dialect.MySQL8Dialect

  # ===== MyBatis 配置 =====
  mybatis-plus:
    mapper-locations: classpath*:/mapper/**/*.xml
    type-aliases-package: com.idata.**.entity
    configuration:
      map-underscore-to-camel-case: true
      cache-enabled: false
      use-deprecated-executor: false

  # ===== 文件上传配置 =====
  servlet:
    multipart:
      max-file-size: 100MB
      max-request-size: 100MB

# ===== JWT 配置 =====
jwt:
  secret: Your-Custom-JWT-Secret-Key-Must-Be-At-Least-32-Characters-Long-12345    # ⚠️ 必须修改!
  expiration: 86400000                    # 24小时(毫秒)

# ===== 日志配置 =====
logging:
  level:
    root: INFO
    com.idata: DEBUG
    org.springframework.web: INFO
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  file:
    name: /home/xiaobofei/apps/idata-ai-platform/logs/idata-auth.log  # ⚠️ 修改为对应的服务名
    max-size: 100MB
    max-history: 30
    total-size-cap: 1GB
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# ===== 自定义配置 =====
idata:
  base-path: /home/xiaobofei/apps/idata-ai-platform
  upload-path: /home/xiaobofei/apps/idata-ai-platform/uploads
  cache:
    enable: true
    ttl: 3600
