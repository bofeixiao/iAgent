# é…ç½®å‚è€ƒæ‰‹å†Œ

## ğŸ“‹ é…ç½®æ–‡ä»¶ä½ç½®

æ‰€æœ‰åç«¯æœåŠ¡çš„é…ç½®æ–‡ä»¶ä½äºï¼š

```
backend/idata-auth/src/main/resources/application.yml
backend/idata-system/src/main/resources/application.yml
backend/idata-app/src/main/resources/application.yml
backend/idata-content/src/main/resources/application.yml
backend/idata-payment/src/main/resources/application.yml
backend/idata-marketing/src/main/resources/application.yml
```

---

## ğŸš€ ä½¿ç”¨æµç¨‹

### æ­¥éª¤1: å¤åˆ¶é…ç½®æ–‡ä»¶

```bash
cd /home/xiaobofei/apps/idata-ai-platform

for service in idata-auth idata-system idata-app idata-content idata-payment idata-marketing; do
    cp config/application-prod.yml backend/$service/src/main/resources/application.yml
done
```

### æ­¥éª¤2: ä¿®æ”¹é…ç½®æ–‡ä»¶

ç¼–è¾‘æ¯ä¸ªæœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š

```yaml
# æ•°æ®åº“è¿æ¥
spring.datasource.url: jdbc:mysql://localhost:3306/idata_ai
spring.datasource.username: idata
spring.datasource.password: Idata@123456

# Redis è¿æ¥
spring.redis.host: localhost
spring.redis.port: 6379

# RabbitMQ è¿æ¥
spring.rabbitmq.host: localhost
spring.rabbitmq.username: idata
spring.rabbitmq.password: Idata@123456

# JWT å¯†é’¥(å¿…é¡»ä¿®æ”¹!)
jwt.secret: Your-Custom-Secret-Key-32-Characters
```

### æ­¥éª¤3: ç¼–è¯‘å¯åŠ¨

```bash
# ç¼–è¯‘
bash scripts/build/build-all.sh

# å¯åŠ¨
bash scripts/deploy/start-services.sh all
```

---

## âš™ï¸ å„æœåŠ¡é…ç½®

### è®¤è¯æœåŠ¡ (idata-auth) - ç«¯å£ 8081

**å…³é”®é…ç½®**:
- JWTå¯†é’¥(å¿…é¡»ä¿®æ”¹)
- æ•°æ®åº“è¿æ¥ä¿¡æ¯
- Redisè¿æ¥ä¿¡æ¯

**æ–‡ä»¶**: `backend/idata-auth/src/main/resources/application.yml`

### ç³»ç»Ÿç®¡ç†æœåŠ¡ (idata-system) - ç«¯å£ 8082

**å…³é”®é…ç½®**:
- æ•°æ®åº“è¿æ¥ä¿¡æ¯
- Redisè¿æ¥ä¿¡æ¯

**æ–‡ä»¶**: `backend/idata-system/src/main/resources/application.yml`

### åº”ç”¨æœåŠ¡ (idata-app) - ç«¯å£ 8083

**å…³é”®é…ç½®**:
- æ•°æ®åº“è¿æ¥ä¿¡æ¯
- Redisè¿æ¥ä¿¡æ¯
- RabbitMQè¿æ¥ä¿¡æ¯

**æ–‡ä»¶**: `backend/idata-app/src/main/resources/application.yml`

---

## ğŸ“ å¸¸è§é…ç½®é€‰é¡¹

### æ•°æ®æºé…ç½®

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/idata_ai?useUnicode=true&characterEncoding=utf8mb4
    username: idata
    password: Idata@123456
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
```

### Redisé…ç½®

```yaml
spring:
  redis:
    host: localhost
    port: 6379
    password: ''
    timeout: 2000
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
```

### RabbitMQé…ç½®

```yaml
spring:
  rabbitmq:
    host: localhost
    port: 5672
    username: idata
    password: Idata@123456
    virtual-host: /
```

### æ—¥å¿—é…ç½®

```yaml
logging:
  level:
    root: INFO
    com.idata: DEBUG
  file:
    name: /home/xiaobofei/apps/idata-ai-platform/logs/idata-auth.log
    max-size: 100MB
    max-history: 30
```

---

## ğŸ” å®‰å…¨å»ºè®®

1. **ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç **
   - MySQL: root â†’ è‡ªå®šä¹‰å¼ºå¯†ç 
   - MySQL idata: Idata@123456 â†’ è‡ªå®šä¹‰å¼ºå¯†ç 
   - RabbitMQ: idata / Idata@123456 â†’ è‡ªå®šä¹‰å¼ºå¯†ç 
   - JWTå¯†é’¥: 32å­—ç¬¦ä»¥ä¸Šçš„å¤æ‚å¯†é’¥

2. **æ•æ„Ÿä¿¡æ¯ä¿æŠ¤**
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†ç 
   - ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶
   - å®šæœŸæ›´æ–°å¯†é’¥

3. **ç”Ÿäº§ç¯å¢ƒé…ç½®**
   - é™ä½æ—¥å¿—levelä¸ºWARN
   - å¯ç”¨HTTPS/SSL
   - é…ç½®é˜²ç«å¢™è§„åˆ™

---

## ğŸ’¡ å¸¸è§é…ç½®é—®é¢˜

### Q: å¦‚ä½•ä¿®æ”¹æœåŠ¡ç«¯å£?

**A**: ç¼–è¾‘é…ç½®æ–‡ä»¶ä¸­çš„ `server.port`:
```yaml
server:
  port: 8091  # ä¿®æ”¹ä¸ºæ–°ç«¯å£
```

### Q: å¦‚ä½•å¯ç”¨HTTPS?

**A**: ç¼–è¾‘é…ç½®æ–‡ä»¶:
```yaml
server:
  port: 8443
  ssl:
    key-store: classpath:keystore.p12
    key-store-password: your-password
    key-store-type: PKCS12
```

### Q: å¦‚ä½•ä¿®æ”¹æ•°æ®åº“è¿æ¥?

**A**: ä¿®æ”¹datasourceé…ç½®:
```yaml
spring:
  datasource:
    url: jdbc:mysql://192.168.1.100:3306/idata_ai
    username: idata
    password: new-password
```

### Q: å¦‚ä½•æŸ¥çœ‹å½“å‰é…ç½®?

**A**: ç¼–è¾‘å¹¶æ£€æŸ¥é…ç½®æ–‡ä»¶:
```bash
cat backend/idata-auth/src/main/resources/application.yml | grep -E "^(server|spring|jwt)"
```

---

## ğŸ” é…ç½®éªŒè¯

### éªŒè¯æ•°æ®åº“è¿æ¥

```bash
mysql -u idata -pIdata@123456 idata_ai -e "SELECT 1;"
```

### éªŒè¯Redisè¿æ¥

```bash
redis-cli ping
```

### éªŒè¯RabbitMQè¿æ¥

```bash
curl -u idata:Idata@123456 http://localhost:15672/api/aliveness-test
```

### éªŒè¯æœåŠ¡ç«¯å£

```bash
netstat -tlnp | grep LISTEN | grep 808
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **config/application-template.yml** - å®Œæ•´é…ç½®æ¨¡æ¿
- **config/application-prod.yml** - ç”Ÿäº§ç¯å¢ƒç¤ºä¾‹
- **scripts/deploy/README.md** - è„šæœ¬ä½¿ç”¨è¯´æ˜
- **QUICK_START.md** - å¿«é€Ÿå¼€å§‹æŒ‡å—

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2026-02-17
